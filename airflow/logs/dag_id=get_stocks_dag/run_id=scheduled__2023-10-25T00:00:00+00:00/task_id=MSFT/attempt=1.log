[2023-10-27 14:19:18,801] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 14:19:18,809] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 14:19:18,837] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 14:19:18,837] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 14:19:18,837] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 14:19:18,910] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): MSFT> on 2023-10-25 00:00:00+00:00
[2023-10-27 14:19:18,915] {standard_task_runner.py:52} INFO - Started process 18200 to run task
[2023-10-27 14:19:18,924] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'MSFT', 'scheduled__2023-10-25T00:00:00+00:00', '--job-id', '70', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmp4xsti1bz', '--error-file', '/tmp/tmp061d1yj3']
[2023-10-27 14:19:18,924] {standard_task_runner.py:80} INFO - Job 70: Subtask MSFT
[2023-10-27 14:19:18,964] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 14:19:19,010] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=MSFT
AIRFLOW_CTX_EXECUTION_DATE=2023-10-25T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-25T00:00:00+00:00
[2023-10-27 14:19:19,837] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/airflow/decorators/base.py", line 179, in execute
    return_value = super().execute(context)
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/gabriel/Documents/project_finance/airflow/dags/get_finance.py", line 18, in get_history
    yfinance.Ticker(ticker).history(
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/pandas/core/generic.py", line 3902, in to_csv
    return DataFrameRenderer(formatter).to_csv(
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/pandas/io/formats/format.py", line 1152, in to_csv
    csv_formatter.save()
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/pandas/io/formats/csvs.py", line 247, in save
    with get_handle(
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/pandas/io/common.py", line 739, in get_handle
    check_parent_directory(str(handle))
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/pandas/io/common.py", line 604, in check_parent_directory
    raise OSError(rf"Cannot save file into a non-existent directory: '{parent}'")
OSError: Cannot save file into a non-existent directory: '/home/gabriel/Documents/project_finance/datalake/stocks/MSFT'
[2023-10-27 14:19:19,849] {taskinstance.py:1395} INFO - Marking task as FAILED. dag_id=get_stocks_dag, task_id=MSFT, execution_date=20231025T000000, start_date=20231027T171918, end_date=20231027T171919
[2023-10-27 14:19:19,864] {standard_task_runner.py:92} ERROR - Failed to execute job 70 for task MSFT (Cannot save file into a non-existent directory: '/home/gabriel/Documents/project_finance/datalake/stocks/MSFT'; 18200)
[2023-10-27 14:19:19,905] {local_task_job.py:156} INFO - Task exited with return code 1
[2023-10-27 14:19:19,931] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-10-27 14:37:44,706] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 14:37:44,789] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 14:37:44,791] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 14:37:44,791] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 14:37:44,792] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 14:37:44,880] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): MSFT> on 2023-10-25 00:00:00+00:00
[2023-10-27 14:37:44,898] {standard_task_runner.py:52} INFO - Started process 21452 to run task
[2023-10-27 14:37:44,916] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'MSFT', 'scheduled__2023-10-25T00:00:00+00:00', '--job-id', '70', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmpvw9t8dj5', '--error-file', '/tmp/tmpj_qsti7a']
[2023-10-27 14:37:44,917] {standard_task_runner.py:80} INFO - Job 70: Subtask MSFT
[2023-10-27 14:37:45,298] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 14:37:45,613] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=MSFT
AIRFLOW_CTX_EXECUTION_DATE=2023-10-25T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-25T00:00:00+00:00
[2023-10-27 14:37:46,355] {python.py:173} INFO - Done. Returned value was: None
[2023-10-27 14:37:46,363] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=MSFT, execution_date=20231025T000000, start_date=20231027T173744, end_date=20231027T173746
[2023-10-27 14:37:46,489] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-10-27 14:37:46,546] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-10-27 14:56:34,396] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 14:56:34,403] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 14:56:34,404] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 14:56:34,404] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 14:56:34,404] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 14:56:34,417] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): MSFT> on 2023-10-25 00:00:00+00:00
[2023-10-27 14:56:34,420] {standard_task_runner.py:52} INFO - Started process 24090 to run task
[2023-10-27 14:56:34,424] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'MSFT', 'scheduled__2023-10-25T00:00:00+00:00', '--job-id', '70', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmponizaqe4', '--error-file', '/tmp/tmpes6jexsc']
[2023-10-27 14:56:34,424] {standard_task_runner.py:80} INFO - Job 70: Subtask MSFT
[2023-10-27 14:56:34,505] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 14:56:34,623] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=MSFT
AIRFLOW_CTX_EXECUTION_DATE=2023-10-25T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-25T00:00:00+00:00
[2023-10-27 14:56:35,211] {python.py:173} INFO - Done. Returned value was: None
[2023-10-27 14:56:35,217] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=MSFT, execution_date=20231025T000000, start_date=20231027T175634, end_date=20231027T175635
[2023-10-27 14:56:35,333] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-10-27 14:56:35,347] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-10-27 15:25:42,096] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 15:25:42,103] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 15:25:42,109] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 15:25:42,109] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 15:25:42,110] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 15:25:42,121] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): MSFT> on 2023-10-25 00:00:00+00:00
[2023-10-27 15:25:42,125] {standard_task_runner.py:52} INFO - Started process 27912 to run task
[2023-10-27 15:25:42,129] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'MSFT', 'scheduled__2023-10-25T00:00:00+00:00', '--job-id', '70', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmpouamz58k', '--error-file', '/tmp/tmpvvdw0rhl']
[2023-10-27 15:25:42,131] {standard_task_runner.py:80} INFO - Job 70: Subtask MSFT
[2023-10-27 15:25:42,180] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 15:25:42,499] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=MSFT
AIRFLOW_CTX_EXECUTION_DATE=2023-10-25T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-25T00:00:00+00:00
[2023-10-27 15:25:43,318] {python.py:173} INFO - Done. Returned value was: None
[2023-10-27 15:25:43,325] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=MSFT, execution_date=20231025T000000, start_date=20231027T182542, end_date=20231027T182543
[2023-10-27 15:25:43,348] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-10-27 15:25:43,363] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-10-27 17:04:57,627] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 17:04:57,635] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 17:04:57,635] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 17:04:57,635] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 17:04:57,635] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 17:04:57,649] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): MSFT> on 2023-10-25 00:00:00+00:00
[2023-10-27 17:04:57,654] {standard_task_runner.py:52} INFO - Started process 40343 to run task
[2023-10-27 17:04:57,657] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'MSFT', 'scheduled__2023-10-25T00:00:00+00:00', '--job-id', '86', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmpxkgky0nl', '--error-file', '/tmp/tmp8krc6ae8']
[2023-10-27 17:04:57,658] {standard_task_runner.py:80} INFO - Job 86: Subtask MSFT
[2023-10-27 17:04:57,715] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 17:04:57,831] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=MSFT
AIRFLOW_CTX_EXECUTION_DATE=2023-10-25T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-25T00:00:00+00:00
[2023-10-27 17:04:58,309] {python.py:173} INFO - Done. Returned value was: None
[2023-10-27 17:04:58,316] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=MSFT, execution_date=20231025T000000, start_date=20231027T200457, end_date=20231027T200458
[2023-10-27 17:04:58,348] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-10-27 17:04:58,368] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-10-27 17:11:56,331] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 17:11:56,336] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 17:11:56,336] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 17:11:56,336] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 17:11:56,336] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 17:11:56,349] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): MSFT> on 2023-10-25 00:00:00+00:00
[2023-10-27 17:11:56,353] {standard_task_runner.py:52} INFO - Started process 42008 to run task
[2023-10-27 17:11:56,357] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'MSFT', 'scheduled__2023-10-25T00:00:00+00:00', '--job-id', '86', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmpxs7umcti', '--error-file', '/tmp/tmpoq740j5h']
[2023-10-27 17:11:56,358] {standard_task_runner.py:80} INFO - Job 86: Subtask MSFT
[2023-10-27 17:11:56,396] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 17:11:56,442] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=MSFT
AIRFLOW_CTX_EXECUTION_DATE=2023-10-25T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-25T00:00:00+00:00
[2023-10-27 17:11:56,865] {python.py:173} INFO - Done. Returned value was: None
[2023-10-27 17:11:56,869] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=MSFT, execution_date=20231025T000000, start_date=20231027T201156, end_date=20231027T201156
[2023-10-27 17:11:56,904] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-10-27 17:11:56,918] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-10-27 18:12:34,099] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 18:12:34,104] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [queued]>
[2023-10-27 18:12:34,104] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 18:12:34,104] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 18:12:34,105] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 18:12:34,116] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): MSFT> on 2023-10-25 00:00:00+00:00
[2023-10-27 18:12:34,120] {standard_task_runner.py:52} INFO - Started process 50158 to run task
[2023-10-27 18:12:34,123] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'MSFT', 'scheduled__2023-10-25T00:00:00+00:00', '--job-id', '85', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmp83d4m192', '--error-file', '/tmp/tmp7m4pmcsv']
[2023-10-27 18:12:34,123] {standard_task_runner.py:80} INFO - Job 85: Subtask MSFT
[2023-10-27 18:12:34,164] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.MSFT scheduled__2023-10-25T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 18:12:34,210] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=MSFT
AIRFLOW_CTX_EXECUTION_DATE=2023-10-25T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-25T00:00:00+00:00
[2023-10-27 18:12:34,624] {python.py:173} INFO - Done. Returned value was: None
[2023-10-27 18:12:34,634] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=MSFT, execution_date=20231025T000000, start_date=20231027T211234, end_date=20231027T211234
[2023-10-27 18:12:34,710] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-10-27 18:12:34,756] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
