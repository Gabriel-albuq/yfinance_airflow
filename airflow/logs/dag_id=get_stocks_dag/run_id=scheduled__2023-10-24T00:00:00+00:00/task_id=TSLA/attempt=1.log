[2023-10-27 14:19:12,627] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 14:19:12,632] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 14:19:12,632] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 14:19:12,632] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 14:19:12,633] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 14:19:12,650] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): TSLA> on 2023-10-24 00:00:00+00:00
[2023-10-27 14:19:12,654] {standard_task_runner.py:52} INFO - Started process 18169 to run task
[2023-10-27 14:19:12,675] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'TSLA', 'scheduled__2023-10-24T00:00:00+00:00', '--job-id', '68', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmplvgl79cs', '--error-file', '/tmp/tmphtkullja']
[2023-10-27 14:19:12,675] {standard_task_runner.py:80} INFO - Job 68: Subtask TSLA
[2023-10-27 14:19:12,787] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 14:19:12,855] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=TSLA
AIRFLOW_CTX_EXECUTION_DATE=2023-10-24T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-24T00:00:00+00:00
[2023-10-27 14:19:13,308] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/airflow/decorators/base.py", line 179, in execute
    return_value = super().execute(context)
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/gabriel/Documents/project_finance/airflow/dags/get_finance.py", line 18, in get_history
    yfinance.Ticker(ticker).history(
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/pandas/core/generic.py", line 3902, in to_csv
    return DataFrameRenderer(formatter).to_csv(
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/pandas/io/formats/format.py", line 1152, in to_csv
    csv_formatter.save()
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/pandas/io/formats/csvs.py", line 247, in save
    with get_handle(
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/pandas/io/common.py", line 739, in get_handle
    check_parent_directory(str(handle))
  File "/home/gabriel/Documents/project_finance/venv/lib/python3.9/site-packages/pandas/io/common.py", line 604, in check_parent_directory
    raise OSError(rf"Cannot save file into a non-existent directory: '{parent}'")
OSError: Cannot save file into a non-existent directory: '/home/gabriel/Documents/project_finance/datalake/stocks/TSLA'
[2023-10-27 14:19:13,314] {taskinstance.py:1395} INFO - Marking task as FAILED. dag_id=get_stocks_dag, task_id=TSLA, execution_date=20231024T000000, start_date=20231027T171912, end_date=20231027T171913
[2023-10-27 14:19:13,327] {standard_task_runner.py:92} ERROR - Failed to execute job 68 for task TSLA (Cannot save file into a non-existent directory: '/home/gabriel/Documents/project_finance/datalake/stocks/TSLA'; 18169)
[2023-10-27 14:19:13,366] {local_task_job.py:156} INFO - Task exited with return code 1
[2023-10-27 14:19:13,383] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-10-27 14:37:34,356] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 14:37:34,410] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 14:37:34,418] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 14:37:34,418] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 14:37:34,419] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 14:37:34,495] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): TSLA> on 2023-10-24 00:00:00+00:00
[2023-10-27 14:37:34,504] {standard_task_runner.py:52} INFO - Started process 21419 to run task
[2023-10-27 14:37:34,508] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'TSLA', 'scheduled__2023-10-24T00:00:00+00:00', '--job-id', '68', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmps0rirokz', '--error-file', '/tmp/tmpmwxz3cch']
[2023-10-27 14:37:34,509] {standard_task_runner.py:80} INFO - Job 68: Subtask TSLA
[2023-10-27 14:37:34,640] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 14:37:34,786] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=TSLA
AIRFLOW_CTX_EXECUTION_DATE=2023-10-24T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-24T00:00:00+00:00
[2023-10-27 14:37:35,280] {python.py:173} INFO - Done. Returned value was: None
[2023-10-27 14:37:35,289] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=TSLA, execution_date=20231024T000000, start_date=20231027T173734, end_date=20231027T173735
[2023-10-27 14:37:35,372] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-10-27 14:37:35,405] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-10-27 14:56:28,960] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 14:56:28,967] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 14:56:28,968] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 14:56:28,968] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 14:56:28,968] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 14:56:28,979] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): TSLA> on 2023-10-24 00:00:00+00:00
[2023-10-27 14:56:28,988] {standard_task_runner.py:52} INFO - Started process 24061 to run task
[2023-10-27 14:56:29,005] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'TSLA', 'scheduled__2023-10-24T00:00:00+00:00', '--job-id', '68', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmprkbnh4vw', '--error-file', '/tmp/tmp1k9x5fcu']
[2023-10-27 14:56:29,005] {standard_task_runner.py:80} INFO - Job 68: Subtask TSLA
[2023-10-27 14:56:29,054] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 14:56:29,124] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=TSLA
AIRFLOW_CTX_EXECUTION_DATE=2023-10-24T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-24T00:00:00+00:00
[2023-10-27 14:56:29,601] {python.py:173} INFO - Done. Returned value was: None
[2023-10-27 14:56:29,607] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=TSLA, execution_date=20231024T000000, start_date=20231027T175628, end_date=20231027T175629
[2023-10-27 14:56:29,639] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-10-27 14:56:29,656] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-10-27 15:25:36,784] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 15:25:36,790] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 15:25:36,791] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 15:25:36,791] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 15:25:36,791] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 15:25:36,803] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): TSLA> on 2023-10-24 00:00:00+00:00
[2023-10-27 15:25:36,807] {standard_task_runner.py:52} INFO - Started process 27884 to run task
[2023-10-27 15:25:36,811] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'TSLA', 'scheduled__2023-10-24T00:00:00+00:00', '--job-id', '68', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmpzwjbpryg', '--error-file', '/tmp/tmpwf6zcaeb']
[2023-10-27 15:25:36,812] {standard_task_runner.py:80} INFO - Job 68: Subtask TSLA
[2023-10-27 15:25:36,849] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 15:25:36,899] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=TSLA
AIRFLOW_CTX_EXECUTION_DATE=2023-10-24T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-24T00:00:00+00:00
[2023-10-27 15:25:37,327] {python.py:173} INFO - Done. Returned value was: None
[2023-10-27 15:25:37,334] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=TSLA, execution_date=20231024T000000, start_date=20231027T182536, end_date=20231027T182537
[2023-10-27 15:25:37,391] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-10-27 15:25:37,408] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-10-27 17:04:47,159] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 17:04:47,168] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 17:04:47,169] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 17:04:47,169] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 17:04:47,169] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 17:04:47,211] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): TSLA> on 2023-10-24 00:00:00+00:00
[2023-10-27 17:04:47,227] {standard_task_runner.py:52} INFO - Started process 40292 to run task
[2023-10-27 17:04:47,231] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'TSLA', 'scheduled__2023-10-24T00:00:00+00:00', '--job-id', '83', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmp4ylgzuwx', '--error-file', '/tmp/tmphx30w8w8']
[2023-10-27 17:04:47,240] {standard_task_runner.py:80} INFO - Job 83: Subtask TSLA
[2023-10-27 17:04:47,382] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 17:04:47,615] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=TSLA
AIRFLOW_CTX_EXECUTION_DATE=2023-10-24T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-24T00:00:00+00:00
[2023-10-27 17:04:48,104] {python.py:173} INFO - Done. Returned value was: None
[2023-10-27 17:04:48,118] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=TSLA, execution_date=20231024T000000, start_date=20231027T200447, end_date=20231027T200448
[2023-10-27 17:04:48,171] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-10-27 17:04:48,288] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-10-27 17:11:49,093] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 17:11:49,099] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 17:11:49,099] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 17:11:49,099] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 17:11:49,099] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 17:11:49,107] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): TSLA> on 2023-10-24 00:00:00+00:00
[2023-10-27 17:11:49,111] {standard_task_runner.py:52} INFO - Started process 41966 to run task
[2023-10-27 17:11:49,115] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'TSLA', 'scheduled__2023-10-24T00:00:00+00:00', '--job-id', '83', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmp_w3yyrpx', '--error-file', '/tmp/tmpbr1kel6k']
[2023-10-27 17:11:49,115] {standard_task_runner.py:80} INFO - Job 83: Subtask TSLA
[2023-10-27 17:11:49,153] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 17:11:49,202] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=TSLA
AIRFLOW_CTX_EXECUTION_DATE=2023-10-24T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-24T00:00:00+00:00
[2023-10-27 17:11:49,804] {python.py:173} INFO - Done. Returned value was: None
[2023-10-27 17:11:49,811] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=TSLA, execution_date=20231024T000000, start_date=20231027T201149, end_date=20231027T201149
[2023-10-27 17:11:49,854] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-10-27 17:11:49,879] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2023-10-27 18:12:26,992] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 18:12:26,998] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [queued]>
[2023-10-27 18:12:26,998] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 18:12:26,998] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2023-10-27 18:12:26,999] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-10-27 18:12:27,007] {taskinstance.py:1377} INFO - Executing <Task(_PythonDecoratedOperator): TSLA> on 2023-10-24 00:00:00+00:00
[2023-10-27 18:12:27,011] {standard_task_runner.py:52} INFO - Started process 50105 to run task
[2023-10-27 18:12:27,014] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'get_stocks_dag', 'TSLA', 'scheduled__2023-10-24T00:00:00+00:00', '--job-id', '82', '--raw', '--subdir', 'DAGS_FOLDER/get_finance.py', '--cfg-path', '/tmp/tmpiz75kark', '--error-file', '/tmp/tmp434ijo65']
[2023-10-27 18:12:27,015] {standard_task_runner.py:80} INFO - Job 82: Subtask TSLA
[2023-10-27 18:12:27,049] {task_command.py:370} INFO - Running <TaskInstance: get_stocks_dag.TSLA scheduled__2023-10-24T00:00:00+00:00 [running]> on host airflow-virtual-machine
[2023-10-27 18:12:27,092] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=get_stocks_dag
AIRFLOW_CTX_TASK_ID=TSLA
AIRFLOW_CTX_EXECUTION_DATE=2023-10-24T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2023-10-24T00:00:00+00:00
[2023-10-27 18:12:27,494] {python.py:173} INFO - Done. Returned value was: None
[2023-10-27 18:12:27,499] {taskinstance.py:1395} INFO - Marking task as SUCCESS. dag_id=get_stocks_dag, task_id=TSLA, execution_date=20231024T000000, start_date=20231027T211226, end_date=20231027T211227
[2023-10-27 18:12:27,520] {local_task_job.py:156} INFO - Task exited with return code 0
[2023-10-27 18:12:27,572] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
